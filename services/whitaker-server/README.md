# Whitaker‑MCP Server

## Overview
Whitaker‑MCP provides a Model Context Protocol (MCP) server that exposes Whitaker’s Words as three tools:

- `analyze_latin`
- `analyze_latin_batch`
- `analyze_latin_text`

The server can run in **STDIO** mode (default, used by CLINE) or **SSE** mode (HTTP endpoint for web demos).

## Prerequisites
- Python 3.9+  
- `pip` (Python package manager)  
- Whitaker’s Words binary installed at `/opt/whitakers-words` (the server expects the binary at `/opt/whitakers-words/bin/words`).  
- (Optional) Docker, if you prefer containerised execution.

## Running the server directly (STDIO)

```bash
cd services/whitaker-server
pip install -r requirements.txt   # install Python dependencies
python whitaker_server.py         # STDIO mode – default, used by CLINE
```

### SSE (Web demo) – optional
```bash
python whitaker_server.py --sse   # exposes HTTP endpoint on port 9090
```

## Running with Docker (without docker‑compose)

### Build the image
```bash
cd services/whitaker-server
docker build -t whitaker-mcp -f Dockerfile.whitaker-server .
```

### Run the container in STDIO mode (no port mapping needed)

```bash
docker run -it --rm \
  -e WHITAKER_BIN=/opt/whitakers-words/bin/words \
  -e WHITAKER_DIR=/opt/whitakers-words \
  whitaker-mcp python whitaker_server.py
```

### Run the container in SSE mode (optional, exposes port 9090)

```bash
docker run -it --rm -p 9090:9090 \
  -e WHITAKER_BIN=/opt/whitakers-words/bin/words \
  -e WHITAKER_DIR=/opt/whitakers-words \
  whitaker-mcp python whitaker_server.py --sse
```

## Stopping / Cleaning up

- When started with `docker run -it …`, stop the server with **Ctrl‑C**.  
- If you start the container detached (`-d`), list containers with `docker ps`, then stop with `docker stop <container-id>`.  
- To remove all stopped containers and the image:

```bash
docker rm -f $(docker ps -aq)      # remove all containers
docker rmi -f whitaker-mcp          # remove the image
```

## Troubleshooting common Docker issues

| Symptom | Likely cause | Fix |
|---------|--------------|-----|
| “Cannot remove image: image is being used by a container” | A container is still running or stopped but not removed | `docker rm -f $(docker ps -aq)` then retry `docker rmi -f whitaker-mcp` |
| “Whitaker not found at /opt/whitakers-words/bin/words” | Whitaker binary not present inside the container | Ensure the Dockerfile copies/install the binary, or mount the host directory containing the binary into the container. |
| “Port 9090 already in use” | Another process/container is bound to 9090 | Stop the conflicting process (`docker ps` → `docker stop …` or kill the host process) or use a different host port (`-p 9091:9090`). |

## License
This server is provided under the same license as the surrounding project. See the top‑level `README.md` for details.

--- 

*Generated by Cline AI assistant.*
