# Augustine MCP Server (Cassandra + FastAPI)

This Docker image bundles a Cassandra database **and** a FastAPI service that wraps the existing `PsalmRAGProcessor`.  
The container starts Cassandra, waits until it is ready, then launches the API.

## Build the image

```bash
# From the project root
docker build -t augustine-mcp -f services/augustine-server/Dockerfile .
```

## Run the container

```bash
docker run -d \
  --name augustine-mcp \
  -p 9042:9042 \   # Cassandra CQL port
  -p 8002:8002 \   # FastAPI API port
  augustine-mcp
```

The container will:

1. Start Cassandra (listening on port **9042**).  
2. Wait until the CQL service is healthy.  
3. Launch the FastAPI server on **0.0.0.0:8002**.

## API Endpoints

| Method | Path      | Description                                 |
|--------|-----------|---------------------------------------------|
| GET    | `/health` | Returns the health check from `PsalmRAGProcessor`. |
| POST   | `/process`| Body must match the `ProcessRequest` model (see source). Returns the processor’s JSON result. |

### Example `POST /process`

```json
{
  "pattern_data": {
    "pattern": "psalm_query",
    "psalm_number": 23,
    "question": "What does Augustine say about Psalm 23?"
  },
  "model": "gpt-4o-mini",
  "stream": false,
  "original_data": {}
}
```

## Notes

* The image uses the official `cassandra:4.1` base image, then installs Python 3, `pip`, and all Python dependencies listed in `services/augustine-server/requirements.txt` (FastAPI, uvicorn, cassandra‑driver, etc.).  
* The `start.sh` script handles the start‑up sequence and runs the FastAPI app as a non‑root user (`apiuser`).  
* If you need to modify the processor or add additional routes, edit `services/augustine-server/augustine_server.py` and rebuild the image.  

---  

*Generated by Cline AI.*
